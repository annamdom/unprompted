{% extends "blog/base.html" %}

{% block content %}

<div class="feed">

    
    <div class="post-card">
        <div class="author">{{ post.author.username }}</div>

        <div class="content">
            {{ post.content|linebreaks }}
        </div>

        <div class="meta">
            {{ post.created_at|date:"M d, Y · H:i" }}
        </div>

        {% if post.author == user %}
            <div style="margin-top:10px; font-size:13px;">
                <a href="{% url 'edit_post' post.id %}">Edit</a>
                ·
                <a href="{% url 'delete_post' post.id %}"
                   style="color:#c0392b;">
                    Delete
                </a>
            </div>
        {% endif %}
    </div>

    
    <h3 style="margin-top:40px;">Comments</h3>

    {% for comment in post.comments.all %}
        <div class="post-card" style="margin-top:12px;">
            <div class="author">{{ comment.author.username }}</div>

            <div class="content">
                {{ comment.text|linebreaks }}
            </div>

            <div class="meta">
                {{ comment.created_at|date:"M d, Y · H:i" }}
            </div>

            {% if comment.author == user %}
                <div style="margin-top:8px; font-size:12px;">
                    <a href="{% url 'delete_comment' comment.id %}"
                       style="color:#c0392b;">
                        Delete
                    </a>
                </div>
            {% endif %}
        </div>
    {% empty %}
        <p style="color:#6E6A66;">No comments yet.</p>
    {% endfor %}

    
    {% if user.is_authenticated %}
        <form method="post" style="margin-top:30px;">
            {% csrf_token %}

            <textarea
                name="text"
                rows="3"
                placeholder="Write a human thought…"
                style="
                    width:100%;
                    padding:12px;
                    border-radius:12px;
                    border:1px solid #ddd;
                    margin-bottom:10px;
                "
                required
            ></textarea>

            <button type="submit"
                style="
                    background:#C65D3B;
                    color:white;
                    border:none;
                    padding:10px 18px;
                    border-radius:999px;
                    font-weight:600;
                ">
                Post comment
            </button>
        </form>
    {% else %}
        <p style="margin-top:20px; color:#6E6A66;">
            Log in to join the conversation.
        </p>
    {% endif %}

</div>

{% endblock %}
